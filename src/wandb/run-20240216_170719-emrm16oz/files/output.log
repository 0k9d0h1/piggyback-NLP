22967
Start of experience:  0
Current Classes:  [0.0, 1.0]
-- >> Start of training phase << --
-- >> Start of eval phase << --
-- Starting eval on experience 0 (Task 0) from test stream --
0it [00:00, ?it/s]
Traceback (most recent call last):
  File "/home/0k9d0h1/piggyback/piggyback-NLP/src/temp.py", line 176, in <module>
    cl_strategy.train(train_exp, eval_streams=[test_exp])
  File "/home/0k9d0h1/piggyback/piggyback-NLP/src/temp.py", line 41, in train
    return super().train(experiences, eval_streams, **kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/avalanche/training/templates/base_sgd.py", line 168, in train
    super().train(experiences, eval_streams, **kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/avalanche/training/templates/base.py", line 140, in train
    self._before_training(**kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/avalanche/training/templates/base.py", line 307, in _before_training
    trigger_plugins(self, "before_training", **kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/avalanche/training/utils.py", line 69, in trigger_plugins
    getattr(p, event)(strategy, **kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/avalanche/training/templates/base_sgd.py", line 556, in before_training
    self._peval(strategy, **kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/avalanche/training/templates/base_sgd.py", line 577, in _peval
    strategy.eval(el, **kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/avalanche/training/templates/base_sgd.py", line 183, in eval
    super().eval(exp_list, **kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/avalanche/training/templates/base.py", line 193, in eval
    self._eval_exp(**kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/avalanche/training/templates/base_sgd.py", line 187, in _eval_exp
    self.eval_epoch(**kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/avalanche/training/templates/base_sgd.py", line 229, in eval_epoch
    self.mb_output = self.forward()
  File "/home/0k9d0h1/piggyback/piggyback-NLP/src/temp.py", line 52, in forward
    return self.model(input_ids=self.input_ids, token_type_ids=self.token_type_ids, attention_mask=self.attention_mask, task_label=task_label)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/0k9d0h1/piggyback/piggyback-NLP/src/modnets/bert.py", line 812, in forward
    return self.forward_single_task(input_ids, attention_mask, token_type_ids, task_label, position_ids, head_mask, inputs_embeds, output_attentions, output_hidden_states, return_dict)
  File "/home/0k9d0h1/piggyback/piggyback-NLP/src/modnets/bert.py", line 827, in forward_single_task
    outputs = self.bert(
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/0k9d0h1/piggyback/piggyback-NLP/src/modnets/bert.py", line 686, in forward
    return self.forward_single_task(input_ids, attention_mask, token_type_ids, task_label, position_ids, head_mask, inputs_embeds, encoder_hidden_states, encoder_attention_mask,
  File "/home/0k9d0h1/piggyback/piggyback-NLP/src/modnets/bert.py", line 748, in forward_single_task
    embedding_output = self.embeddings(
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/0k9d0h1/piggyback/piggyback-NLP/src/modnets/bert.py", line 65, in forward
    return self.forward_single_task(input_ids, token_type_ids, task_label, position_ids, inputs_embeds, past_key_values_length)
  File "/home/0k9d0h1/piggyback/piggyback-NLP/src/modnets/bert.py", line 95, in forward_single_task
    inputs_embeds = self.word_embeddings(input_ids)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/torch/nn/modules/sparse.py", line 162, in forward
    return F.embedding(
  File "/home/0k9d0h1/anaconda3/envs/DHK/lib/python3.10/site-packages/torch/nn/functional.py", line 2233, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)